\documentclass{mynotes}

\usepackage{amsmath,amsfonts,amsthm,amssymb}
\usepackage{bm}
%\usepackage{indentfirst}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{emoji}

\usepackage{subcaption}
\usepackage{multicol}
\usepackage{multirow}

\usepackage{tikz}
\usepackage{listings}

\usepackage{epigraph}
\renewcommand*{\epigraphsize}{\normalsize}
\PassOptionsToPackage{hyphens}{url}

\newcommand{\MC}{\mathcal{C}}
\newcommand{\FF}{\mathbb{F}}
\newcommand{\NN}{\mathbb{N}}
\newcommand{\ZZ}{\mathbb{Z}}
\newcommand{\RR}{\mathbb{R}}
\newcommand{\II}{\mathbb{I}}
\newcommand{\CC}{\mathbb{C}}

% affine space
\newcommand{\Vv}{\mathcal{V}}
\newcommand{\Aa}{\mathcal{A}}

\DeclareMathOperator{\Ima}{im}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\sign}{sign}
\DeclareMathOperator{\spa}{spa}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\lb}{label}

\setlength{\parskip}{4pt}
\addbibresource{references.bib}

\setcounter{tocdepth}{1}

\setlist[itemize,enumerate]{noitemsep,nosep,leftmargin=*}

\begin{document}

\tableofcontents

\chapter{Ma trận}

Trong các bài viết của về đại số tuyến tính:

\begin{itemize}
    \item Vector sẽ được ký hiệu bởi chữ thường in đậm (ví dụ $\bm{v}, \bm{x}, \ldots$)​; 
    \item Ma trận sẽ được ký hiệu bởi chữ hoa in đậm (ví dụ $\bm{A},\ \bm{B}, \ldots$​);
    \item Các đại lượng vô hướng (số) được ký hiệu bởi chữ thường không in đậm (ví dụ $x_1,\ N,\ t, \ldots$).
\end{itemize}

\section{Định thức và hạng ma trận}

\subsection*{Định thức ma trận}

\begin{definition}[Nghịch thế]
    Cho tập hợp $A = \{1, 2, \cdots, n\}$ và xét hoán vị $\sigma$ trên ​$A$. Ta gọi hai phần tử $i$​ và $j$​ tạo thành \textbf{nghịch thế} (inversion) nếu $i < j$​ và $\sigma(i) > \sigma(j)$.

    Đặt $\sigma = \{k_1, k_2, \cdots, k_n\}$​ là một hoán vị của $A$​. Ta ký hiệu \[ P\{k_1, k_2, \cdots, k_n\} \] là số lượng nghịch thế của $\sigma$​ và đặt \[ (-1)^{P\{k_1, k_2, \cdots, k_n\}} = \sign \{k_1, k_2, \cdots, k_n\}. \]
\end{definition}

\begin{example}
    Với $n=4$​, $A = \{1, 2, 3, 4\}$​. Xét hoán vị $\sigma = \{4, 2, 1, 3\}$.

    Ta nhận thấy các cặp nghịch thế $(4, 2),\ (4, 1),\ (4, 3),\ (2, 1)$​ gồm 4 cặp nghịch thế. Vậy $P\{4, 2, 1, 3\} = 4$ và $\sign \{4, 2, 1, 3\}=(-1)^4=1$​.
\end{example}

\begin{definition}[Định thức]
    Khi đó định thức của ma trận $\bm{A} = \begin{pmatrix}a_{11} & a_{12} & \cdots & a_{1n} \\ a_{21} & a_{22} & \cdots & a_{2n} \\ \cdots & \cdots & \cdots & \cdots \\ a_{n1} & a_{n2} & \cdots & a_{nn}\end{pmatrix}$ được định nghĩa là:
    \begin{equation}
        \det(\bm{A})=\displaystyle{\sum_{(i_1, i_2, \cdots, i_n)} a_{1, i_1} \cdot a_{2, i_2} \cdot a_{n, i_n} \cdot \sign\{i_1, i_2, \cdots, i_n\}}
    \end{equation}
    với mọi hoán vị $(i_1, i_2, \cdots, i_n)$ của $(1, 2, \cdots, n)$. Như vậy có $n!$​ phần tử cho tổng trên.
\end{definition}


\begin{example}
    Tính định thức ma trận $\bm{A}=\begin{pmatrix}1 & 2 & 3 \\ 4 & 5 & 6 \\ 7 & 8 & 9\end{pmatrix}$​.

    Xét hoán vị $\sigma_1 = \{1, 2, 3\}$​. Khi đó $P\{1, 2, 3\}=0$​, $a_{11} \cdot a_{22} \cdot a_{33} \cdot (-1)^0 = 1 \cdot 5 \cdot 9 \cdot 1 = 45$​.

    Xét hoán vị $\sigma_2 = \{1, 3, 2\}$​. Khi đó $P\{1, 3, 2\} = 1$​, $a_{11} \cdot a_{23} \cdot a_{32} \cdot (-1)^1 = 1 \cdot 6 \cdot 8 \cdot (-1) = -48$.

    Xét hoán vị $\sigma_3 = \{2, 1, 3\}$​. Khi đó $P\{2,1,3\}=1$​, $a_{12} \cdot a_{21} \cdot a_{33} \cdot (-1)^1 = 2 \cdot 4 \cdot 9 \cdot (-1) = -72$.

    Xét hoán vị $\sigma_4=\{2,3,1\}$. Khi đó $P\{2, 3, 1\} = 2$​, $a_{12} \cdot a_{23} \cdot a_{31} \cdot (-1)^2 = 2 \cdot 6 \cdot 7 \cdot 1 = 84$​.

    Xét hoán vị $\sigma_5=\{3, 1, 2\}$. Khi đó $P\{3, 1, 2\} = 2$​, $a_{13} \cdot a_{21} \cdot a_{32} \cdot (-1)^2 = 3 \cdot 4 \cdot 8 \cdot 1 = 96$​.

    Xét hoán vị $\sigma_6=\{3, 2, 1\}$​. Khi đó $P\{3, 2, 1\}=3$​, $a_{13} \cdot a_{22} \cdot a_{31} \cdot (-1)^3 = 3 \cdot 5 \cdot 7 \cdot  (-1) = -105$​.

    Như vậy $\det(A)=45-48-72+84+96-105=0$​.
\end{example}

Định thức của ma trận còn được định nghĩa theo \textbf{đệ quy} như sau:

Với ma trận $1 \times 1$ là $\bm{A}=\begin{pmatrix}a_{11}\end{pmatrix}$ thì $\det(\bm{A})=a_{11}$.

Với ma trận $2 \times 2$ là $\bm{A} = \begin{pmatrix}a_{11} & a_{12} \\ a_{21} & a_{22}\end{pmatrix}$​ thì $\det(\bm{A})=a_{11}a_{22} - a_{21}a_{12}$.

Với ma trận $n \times n$, gọi $\bm{M}_{ij}$ là ma trận có được từ ma trận $\bm{A}$ khi bỏ đi hàng $i$​ và cột $j$​ của ma trận $\bm{A}$ và ký hiệu $A_{ij}=(-1)^{i+j} \det (\bm{M}_{ij})$. Khi đó:

\begin{theorem}[Định lý Laplace]
    Định lý Laplace cho phép ta khai triển định thức của ma trận cấp $n$ thành tổng các ma trận cấp $n-1$.

    Khai triển theo cột $j$​: \[ \det(\bm{A})=\displaystyle{\sum_{i=1}^na_{ij} A_{ij}} = a_{1j} A_{1j} + a_{2j} A_{2j} + \cdots + a_{nj} A_{nj},\ j = \overline{1, n}.\]

    Khai triển theo hàng $i$​: \[ \det(\bm{A})=\displaystyle{\sum_{j=1}^n a_{ij} A_{ij}} = a_{i1} A_{i1} + a_{i2} A_{i2} + \cdots + a_{in} A_{in},\ i = \overline{1, n}. \]​
\end{theorem}

\subsection*{Hạng của ma trận}

\begin{definition}[Hạng của ma trận]
    Cho ma trận $\mathbf{A}_{m \times n}$. \textbf{Hạng} của ma trận là cấp của ma trận con lớn nhất có định thức khác 0. Nghĩa là một ma trận vuông mà là ma trận con (lấy 1 phần của ma trận gốc) kích thước $r \times r$ mà có định thức khác 0, thì hạng của ma trận khi đó là $r$. Dễ thấy do là ma trận con, và vuông, nên $r \leqslant \min(m, n)$.
\end{definition}

\begin{example}
    Ma trận $\bm{A} = \begin{pmatrix}
        1 & 2 & 3 \\ 2 & 4 & 6 \\ 1 & 2 & 4
    \end{pmatrix}$ có định thức $\det(\bm{A}) = 0$. 
    
    Nhưng ma trận con của $\bm{A}$ là $\bm{B} = \begin{pmatrix}2 & 3 \\ 2 & 4\end{pmatrix}$ (lấy dòng 1 và 3, lấy cột 2 và 3) có định thức $\det(\bm{B}) = 2 \neq 0$, do đó $r = \text{rank}(\bm{A}) = 2$ ($\text{rank}(\bm{A})$ nghĩa là hạng của $\bm{A}$).
\end{example}

\section{Ma trận nghịch đảo}

Ma trận $\bm{A}^{-1}$​ được gọi là \textbf{ma trận nghịch đảo} của ma trận vuông $\bm{A}$ nếu $\bm{A}^{-1} \cdot \bm{A} = \bm{A} \cdot \bm{A}^{-1} = \bm{I}$​. Trong đó $\bm{I}$ là ma trận đơn vị cùng kích thước với $\bm{A}$.

\begin{equation}
    \bm{A}^{-1}=\frac{1}{\det(\bm{A})}[(A_{ij})_n]^T=\frac{1}{\det(\bm{A})}\begin{pmatrix} A_{11} & A_{21} & \cdots & A_{n1} \\ A_{12} & A_{22} & \cdots & A_{n2} \\ \cdots & \cdots & \cdots & \cdots \\ A_{1n} & A_{2n} & \cdots & A_{nn} \end{pmatrix}
\end{equation}
Trong đó, $A_{ij}$ cũng được định nghĩa tương tự như khi tính định thức bằng khai triển theo dòng hoặc cột. Gọi $\bm{M}_{ij}$ là ma trận có được từ ma trận $\bm{A}$ khi bỏ đi hàng $i$​ và cột $j$​ của ma trận $\bm{A}$ và ký hiệu $A_{ij}=(-1)^{i+j} \det (\bm{M}_{ij})$.

Như vậy, điều kiện cần và đủ để một ma trận có nghịch đảo là định thức khác 0.

\chapter{Discrete logarithm}

\section{Các thuật toán tính discrete logarithm}

Thuật toán Baby-Step-Giant-Step (BSGS) giúp tính discrete logarithm trên nhóm cyclic với order là số nguyên tố \ref{alg:bsgs}.

\begin{algorithm}[H]
    \caption{Thuật toán Baby-Step-Giant-Step}
    \label{alg:bsgs}
    \begin{algorithmic}[1]
        \Require Nhóm cyclic $G$ có order $n$, generator $g$ và phần tử $h \in G$.
        \Ensure Số $x$ duy nhất thuộc $\{ 0, 1, \ldots, n-1 \}$ thỏa $g^x = h$.
        $m \gets \lfloor \sqrt{n} \rfloor$
        \For{$j = 0 \to m-1$}
            \State Tính $g^j$. Lưu $(j, g^j)$ vào bảng.
        \EndFor
        \State Tính $g^{-m}$.
        \State $\gamma \gets h$.
        \For{$i = 0 \to m-1$}
            \State a) Kiểm tra điều kiện $\gamma = g^j$ với $j = 0, 1, \ldots, m-1$.
            \State b) Nếu điều kiện thỏa, trả về $im + j$.
            \State c) Nếu không, đặt $\gamma \gets \gamma \cdot g^{-m}$.
        \EndFor
    \end{algorithmic}
\end{algorithm}

Khi order của cyclic group là lũy thừa một số nguyên tố thì ta dùng thuật toán Pohlig-Hellman \ref{alg:pohlig}.

\begin{algorithm}[H]
    \caption{Thuật toán Pohlig-Hellman}
    \label{alg:pohlig}
    \begin{algorithmic}[1]
        \Require Nhóm cyclic $G$ có order $n=p^e$, generator $g$ và phần tử $h \in G$.
        \Ensure Số $x$ duy nhất thuộc $\{ 0, 1, \ldots, n-1 \}$ thỏa $g^x = h$.
        \State Khởi tạo $x_0 = 0$.
        \State Tính $\gamma = g^{p^{e-1}}$. Theo định lý Lagrange, $\gamma$ có order là $p$.
        \For{$k = 0 \to e-1$}
            \State a) Tính $h_k = (g^{-x_k} \cdot h)^{e-1-k}$.
            \State b) Sử dụng thuật toán baby-step-giant-step, tìm $d_k \in \{ 0, 1, \ldots, p-1 \}$ sao cho $\gamma^{d_k} = h_k$. % Bước này có độ phức tạp $O(\sqrt{p})$.
            \State c) Tính $x_{k+1} = x_k + p^k d_k$.
        \EndFor
        \State Trả về $x_e$ là kết quả cần tìm.
    \end{algorithmic}
\end{algorithm}

\chapter{Số học}

\epigraph{{\rmfamily Toán học là vua của các môn khoa học, và số học là nữ hoàng}}{Carl Friedrich Gauss}

\section{Phép chia Euclid và thuật toán Euclid}

\subsection*{Phép chia Euclid}

Đây là nền tảng, cơ sở của số học. Từ khi biết tới phép chia hai số nguyên, ta có thể tìm \textit{thương} và \textit{số dư}. Nói theo toán học, nếu ta có hai số nguyên dương $a$ và $b$ thì tồn tại cặp số $q$, $r$ sao cho $a = qb + r$ với $0 \leqslant r < b$.

Khi đó, $a$ gọi là số bị chia, $b$ gọi là số chia, $q$ là thương (q trong quotient) và $r$ là số dư (r trong remainder).

Đặc biệt là sự tồn tại của cặp số $q$ và $r$ là duy nhất. Thật vậy, nếu ta giả sử tồn tại 2 cặp số $(q_1, r_1)$ và $(q_2, r_2)$  đều thỏa đẳng thức trên, nghĩa là
\[a = q_1 b + r_1, \quad a = q_2 b + r_2\]

Trừ 2 đẳng thức vế theo vế ta có $(q_1 - q_2) b + (r_1 - r_2) = 0$. Tương đương $(r_2 - r_1) = (q_1 - q_2) b$, mà $0 \leqslant r_1, r_2 < b$ nên $-b < r_2 - r_1 < b$. Như vậy chỉ có thể xảy ra trường hợp
$r_2 - r_1 = 0$ hay $r_2 = r_1$, kéo theo $q_1 = q_2$.

\subsection*{Thuật toán Euclid}

Dựa trên phép chia Euclid, ta có một thuật toán hiệu quả để tìm ước chung lớn nhất giữa hai số $a$ và $b$.

Ký hiệu $\gcd(a, b)$ là ước chung lớn nhất của $a$ và $b$. Chúng  ta thực hiện đệ quy như sau:
\begin{equation*}
    \gcd(a, b) = \begin{cases}
        a, \quad & \text{nếu}\,b = 0 \\
        \gcd(b, a \bmod b), \quad & \text{nếu}\,b \neq 0
    \end{cases} 
\end{equation*}

Điểm quan trọng ở thuật toán Euclid là thuật toán chắc chắn sẽ dừng sau một số hữu hạn bước, và kết quả sẽ là ước chung lớn nhất của hai số $a$ và $b$.

\begin{proof}
    Đặt $r_0 = a$ và $r_1 = b$. Theo thuật chia Euclid ta có các số $q_0$ và $r_2$ sao cho $r_0 = r_1 q_0 + r_2$ với $0 \leqslant r_2 < r_1$. Thuật toán Euclid hoạt động như sau:
    \begin{align*}
        r_0 & = r_1 q_0 + r_2 \\
        r_1 & = r_2 q_1 + r_3 \\
        r_2 & = r_3 q_2 + r_4 \\
        \ldots & = \ldots \\
        r_i & = r_{i+1} q_i + r_{i+2} \\
        \ldots & = \ldots \\
        r_k & = r_{k+1} q_k + 0 \\
        r_{k+1} & = 0
    \end{align*}
    Ta thấy rằng ở mỗi bước, $r_{i+2}$ luôn nhỏ hơn $r_{i+1}$. Do đó cuối cùng sẽ bằng 0, và khi đó ta có ước chung lớn nhất.
\end{proof}

\subsection*{Thuật toán Euclid mở rộng}

\begin{definition}[Phương trình Diophantos]
    Cho trước các số nguyên $a$, $b$ và $c$. Phương trình  Diophantus là phương trình có dạng
    \[ax + by = c\]
    với $x$, $y$ là các số nguyên.
\end{definition}

\begin{example}
    Giải phương trình $5x+3y = 1$.

    Ta có $y = \dfrac{1-5x}{3} = \dfrac{1-2x-3x}{3} = \dfrac{1-2x}{3} - x$. Như vậy nếu $y \in \ZZ$ thì $\dfrac{1-2x}{3} \in \ZZ$, nghĩa là $1-2x$ chia hết cho 3. Vậy $1-2x = 3k$ với $k \in \ZZ$.

    Tiếp tục, $1-2x = 3k$, suy ra $x = \dfrac{1-3k}{2}  = \dfrac{1-k-2k}{2} = \dfrac{1-k}{2} - k$. Do $x$ nguyên nên tương tự $\dfrac{1-k}{2}$ cũng nguyên, hay $1-k = 2t$, tương đương với $k = 1-2t$.

    Thay ngược lại ta có $x = \dfrac{1-3k}{2} = \dfrac{1-3(1-2t)}{2} = {-1+3t}$. Tiếp tục thay vào để tìm $y$ thì $y = \dfrac{1-5x}{3} = \dfrac{1-5(-1+3t)}{3} = 2 - 5t$.

    Như vậy nghiệm của phương trình là tất cả các nghiệm $(x, y)$ mà $x = -1+3t$, $y = 2-5t$ với $t \in \ZZ$.
\end{example}

Ở đây chúng ta đã thực hiện phép chia có dư liên tiếp để tìm nghiệm. Nói cách khác ta đã thực hiện thuật toán Euclid ở bên trên để làm giảm độ phức tạp ở mỗi bước giải. Tổng quát ta có thuật toán Euclid mở rộng để tìm ước chung lớn nhất $\gcd(a, b)$ của hai số $a$, $b$, và \textbf{một} nghiệm của phương trình $ax + by = \gcd(a, b)$.

Ở ví dụ trên, ta thấy rằng $(-1, 2)$ là một nghiệm của phương trình $5x + 3y = 1$. Khi đó ta có thể suy ra tất cả nghiệm (họ nghiệm) của phương trình có dạng $(-1+3t, 2-5t)$ với $t \in \ZZ$.

\begin{algorithm}
    \caption{Thuật toán Euclid mở rộng}
    \begin{algorithmic}
        \Require $a, b \in \ZZ$
        \Ensure $\gcd(a, b)$, $x$, $y$ 
        \State $r_0 \gets a$, $r_1 \gets b$, $r_2 \gets 0$
        \State $x_0 \gets 1$, $x_1 \gets 0$, $x_2 \gets 0$
        \State $y_0 \gets 0$, $y_1 \gets 1$, $y_2 \gets 0$
        \While{$r_1 \neq 0$}
            \State $q \gets r_0 \;\text{div}\; r_1$
            \State $r_2 \gets r_0 - q * r_1$, $r_0 \gets r_1$, $r_1 \gets r_2$
            \State $x_2 \gets x_0 - q * x_1$, $x_0 \gets x_1$, $x_1 \gets x_2$
            \State $y_2 \gets y_0 - q * y_1$, $y_0 \gets y_1$, $y_1 \gets y_2$
        \EndWhile
        \State \Return $r_0$, $x_0$, $y_0$
    \end{algorithmic}
\end{algorithm}

Ở thuật toán trên, $r_0$, $r_1$ và $r_2$ hoạt động như thuật toán Euclid chuẩn. Ở mỗi bước $q$ là thương của phép chia hai số nguyên và ta sử dụng $q$ đó để tính $x_0$ và $y_0$ mới. Kết quả cuối cùng $(r_0, x_0, y_0)$ lần lượt là ước chung lớn nhất, và hai số $x$, $y$ thỏa mãn $a x_0 + y b_0 = r_0$.

Tại sao chúng ta lại có $(x_0, x_1) = (1, 0)$ và $(y_0, y_1) = (0, 1)$? Nói cách khác, làm sao biết thuật toán  hoạt động đúng?

Mục đích của chúng ta là tìm các số $(x, y)$ sao cho $ax + by = \gcd(a, b)$. Khi đó, dựa trên thuật toán Euclid cơ bản ở trên, ta xây dựng dãy số $\{x_n\}$ và $\{y_n\}$ sao cho ở mọi bước thứ $n$ ta đều có

\begin{equation}\label{euclid:1}
    a x_n + b y_n = r_n
\end{equation}

Ta có $r_i = r_{i+1} q_i + r_{i+2}$. Từ $q_i$ ở mỗi bước ta tính được
\begin{equation*}
    x_i = x_{i+1} q_i + x_{i+2}, \quad y_i = y_{i+1} q_i + y_{i+2}
\end{equation*}

Thay vào \ref{euclid:1} ta được
\begin{equation}
    a (x_{i+1} q_i + x_{i+2}) + b (y_{i+1} q_i + y_{i+2}) = r_i
\end{equation}

Tương đương với \[(a x_{i+1} + b y_{i+1}) q_i + (a x_{i+2} + b x_{i+2}) = r_i\]

Mà $a x_{i+1} + b y_{i+1} = r_{i+1}$ và $a x_{i+2} + b y_{i+2} = r_{i+2}$. Suy ra $r_{i+1} q_i + r_{i+2} = r_n$, đúng với thuật toán Euclid chuẩn ban đầu. Nghĩa là thuật toán hoạt động đúng. Bây giờ ta cần chọn $(x_0, x_1)$ và $(y_0, y_1)$ vì chúng ta đã đặt $r_0 = a$ và $r_1 = b$. Ở bước thứ 0, \[r_0 = a = a x_0 + b y_0\] và ở bước thứ 1,
\[r_1 = b = a x_1 + b y_1\]

Dễ thấy ở bước 0 ta chọn $(1, 0)$ và ở bước 1 ta chọn $(0, 1)$ là được.

\section{Hàm Euler}

\begin{definition}[Phi hàm Euler]
    Cho số nguyên dương $n$. Số lượng các số dương nhỏ hơn $n$ và nguyên tố cùng nhau với $n$ được ký hiệu bởi $\phi(n)$ và gọi là $\phi$ hàm Euler. \[ \phi(n) = \lvert \{ a : (a, n) = 1\} \rvert \]
\end{definition}   

Hàm Euler có ý nghĩa quan trọng trong lý thuyết số, công cụ giúp chúng ta giải các vấn đề về số mũ trong modulo.

Sau đây chúng ta xem xét hệ thặng dư đầy đủ và hệ thặng dư thu gọn.

Với số nguyên dương $n$, ta định nghĩa

\begin{definition}[Hệ thặng dư đầy đủ]
    Hệ thặng dư đầy đủ của $n$ là tập $\{0, 1, \ldots, n-1\}$.
\end{definition}

Nói cách khác, hệ thặng dư đầy đủ của $n$ là các số dư có thể có khi chia một số bất kì cho $n$.

\begin{definition}[Hệ thặng dư thu gọn]
    Hệ thặng dư thu gọn của $n$ là tập các số $a$ mà $1 \leqslant a < n$ và $(a, n) = 1$. Số lượng các số $a$ như vậy là $\phi (n)$.  
\end{definition}

\begin{remark}
    \begin{enumerate}
        \item Hệ thặng dư thu gọn của $n$ gồm $\phi(n)$ phần tử là \[ \{a_1, a_2, \ldots, a_{\phi(n)}\} \]
        \item Nếu $n$ là số nguyên tố thì $\phi(n) = n-1$.
    \end{enumerate}
\end{remark}

\subsection*{Tính chất hàm Euler}

\begin{remark}
    Với $(m, n) = 1$ thì $\phi(m n) = \phi(m) \phi(n)$.
\end{remark}

\begin{proof}
    Ta viết các số từ 1 tới $mn$ thành bảng như sau

    \begin{table}
        \centering
        \begin{tabular}{c c c c}
            1 & $m+1$ & $\cdots$ & $(n-1)m + 1$ \\
            2 & $m+2$ & $\cdots$ & $(n-1)m + 2$ \\
            $\cdots$ & $\cdots$ & $\cdots$ & $\cdots$ \\
            $m$ & $m+m$ & $\cdots$ & $(n-1)m + m$
        \end{tabular}
    \end{table}
    
    Hàng $r$ gồm các phần tử dạng $r m + k$ với $0 \leqslant r \leqslant n-1$ và $1 \leqslant k \leqslant m$.  Ta thấy rằng nếu $(rm + k, m) = 1$ thì $(k, m) = 1$.

    Do đó trên mỗi hàng có $\phi(m)$ phần tử nguyên tố cùng nhau với $m$.

    Tiếp theo, trên các hàng vừa tìm được, do $(m, n) = 1$ nên để $(rm + k, n) = 1$ thì $(r, n) = 1$. Nghĩa là có $\phi(n)$ hàng như vậy.

    Tổng kết lại, ta có $\phi(m) \phi(n)$ phần tử trong bảng nguyên tố cùng nhau với $mn$. Do đó có điều phải chứng minh.
\end{proof}

Do tính chất này nên hàm Euler là hàm nhân tính.

\begin{remark}
    Cho số nguyên dương $n$. Khi đó $\displaystyle{\sum_{d | n} \phi(d) = n}$.
\end{remark}

\begin{proof}
    Giả sử phân tích thừa số nguyên tố của $n$ là 
    \begin{equation*}
        n = p_1^{e_1} p_2^{e_2} \ldots p_k^{e_k}
    \end{equation*}

    Khi đó mỗi ước $d$ của $n$ đều có dạng $p_1^{f_1} p_2^{f_2} \ldots p_k^{f_k}$ với $0 \leqslant f_i \leqslant e_i$ với $i = 1, 2, \ldots, k$.

    Như vậy
    \begin{equation*}
        \sum_{d | n} \phi(d) = \sum_{0 \leqslant f_i \leqslant e_i} \phi\Big(p_1^{f_1} p_2^{f_2} \ldots p_k^{f_k}\Big)
                            = \phi\Big(p_1^{f_1}\Big) \phi\Big(p_2^{f_2}\Big) \ldots \phi\Big(p_k^{f_k}\Big)
    \end{equation*}

    Một dạng biểu thức đơn giản là $(1+x)(1+y) = 1+x+y+xy$ hay với 3 biến là $(1+x)(1+y)(1+y) = 1 + x + y + z + xy + yz + yz + xyz$. Tổng quát cho $k$ biến ở trên thì biểu thức tương đương với
    \begin{align*}
        \sum_{0 \leqslant f_i \leqslant e_i} \phi(p_1^{f_1}) \phi(p_2^{f_2}) \ldots
        \phi(p_k^{f_k}) = & (1 + \phi(p_1) + \phi(p_1^2) + \ldots + \phi(p_1^{e_1})) \\
        \times & (1 + \phi(p_2) + \phi(p_2^2) + \ldots + \phi(p_2^{e_2})) \\
        \times & \ldots \\
        \times & (1 + \phi(p_k) + \phi(p_k^2) + \ldots + \phi(p_k^{e_k}))
    \end{align*}

    Ở đây ta rút gọn dễ dàng với $i = 1, 2, \ldots, k$:
    \begin{align*}
        & 1 + \phi(p_i) + \phi(p_i^2) + \ldots + \phi(p_i^{e_i}) \\
        = & 1 + p_i - 1 + p_i^2 - p_i + \ldots + p_i^{e_i} - p_i^{e_i-1} \\
        = & p_i^{e_i}
    \end{align*}

    Như vậy mỗi tổng $1 + \phi(p_i) + \ldots$ bằng chính $p_i^{e_i}$. Nhân chúng lại với nhau ta có lại $n$.
\end{proof}

\subsection*{Định lý Euler}

\begin{theorem}[Định lý Euler]    
    Cho số nguyên dương $n$. Với mọi số nguyên $a$ mà $(a, n) = 1$ thì 
    \begin{equation}
        a^{\phi(n)} \equiv 1 \pmod n
    \end{equation}
\end{theorem}

\begin{proof}
    Giả sử $S = \{a_1, a_2, \ldots, a_{\phi(n)}\}$ là hệ thặng dư thu gọn của $n$. Ta sẽ chứng minh rằng nếu $a$ là số sao cho $(a, n)=1$ thì tập hợp
    \begin{equation*}
        \{a a_1, a a_2, \ldots, a a_{\phi(n)}\}
    \end{equation*}
    là hoán vị của tập $S$.

    Thật vậy, giả sử $a a_i \equiv a a_j \pmod n$ với $1 \leqslant i, j \leqslant \phi(n)$ và $i \neq j$.

    Do $(a, n) = 1$ nên tồn tại nghịch đảo $a' \pmod n$, nhân $a'$ cho 2 vế ta còn $a_i \equiv a_j \pmod n$.

    Nói cách khác, nếu $a_i \not\equiv a_j \pmod n$ thì $a a_i \not\equiv a a_j \pmod n$. Suy ra tập
    \begin{equation*}
        \{a a_1, a a_2, \ldots, a a_{\phi(n)}\}
    \end{equation*}
    là hoán vị của $S$.

    Ta nhân tất cả phần tử của $S$ thì sẽ bằng tích phần tử của tập trên
    \begin{equation*}
        a a_1 \cdot a a_2 \ldots a a_{\phi(n)} \equiv a_1 \cdot a_2 \ldots a_{\phi(n)} \pmod n
    \end{equation*}

    Đặt $I = a_1 \cdot a_2 \ldots a_{\phi(n)}$ thì phương trình trên tương đương với 
    \begin{equation*}
        a^{\phi(n)} I \equiv I \pmod n
    \end{equation*}
    
    Mà $(I, n) = 1$ do là tích các số nguyên tố cùng nhau với $n$ nên rút gọn hai vế ta được
    \begin{equation*}
        a^{\phi(n)} \equiv 1 \pmod n
    \end{equation*}
    Ta có điều phải chứng minh.
\end{proof}

\subsection*{Định lý Fermat nhỏ}

\begin{theorem}[Định lý Fermat nhỏ]    
    Cho số nguyên tố $p$. Với mọi số nguyên $a$ thì $$a^p \equiv a \pmod p$$

    Khi $(a, p) = 1$ thì
    \begin{equation*}
        a^{p-1} \equiv 1 \pmod p
    \end{equation*}
\end{theorem}

\begin{remark}
    Khi $(a, p) = 1$ thì định lý Fermat là hệ quả trực tiếp từ định lý Euler.
\end{remark}

\section{Thặng dư chính phương}

\begin{definition}[Số chính phương modulo $p$]
    Xét số dương nguyên tố lẻ $p$. Số $a$ được gọi là \textbf{số chính phương modulo $p$} nếu $(a, m) = 1$ và tồn tại số $x$ sao cho $x^2 = a \pmod p$.

    Nói cách khác phương trình đồng dư $x^2 \equiv a \pmod p$ có nghiệm.
\end{definition}

Chúng ta sử dụng kí hiệu Legendre (Legendre symbol) để thể hiện một số $a$ có phải là số chính phương modulo nguyên tố $p$ không.

\begin{definition}[Legendre symbol]
    Xét $p$ là số nguyên tố, $a$ là số nguyên không chia hết cho $p$. Khi đó kí hiệu Legendre được định nghĩa là
    \begin{equation}
        \left(\frac{a}{p}\right) = \begin{cases}
            1, & \text{ nếu } a \text{ là số chính phương modulo } p. \\
            -1, & \text{ nếu ngược lại.}
        \end{cases}
    \end{equation}
\end{definition}

Một trường hợp tổng quát hơn của kí hiệu Legendre là kí hiệu Jacobi áp dụng cho số nguyên dương bất kì.
\begin{definition}[Jacobi symbol]
    Xét $n$ là số nguyên dương, $a$ là số nguyên không chia hết cho $n$. Khi đó kí hiệu Jacobi được định nghĩa là
    \begin{equation}
        \left(\frac{a}{n}\right) = \begin{cases}
            1, & \text{ nếu } a \text{ là số chính phương modulo } n \\
            -1, & \text{ nếu ngược lại.}
        \end{cases}
    \end{equation}
\end{definition}

\input{lattice_crypto.tex}

\chapter{Quan hệ hai ngôi}

\section{Quan hệ hai ngôi}

\begin{definition}[Quan hệ hai ngôi]
    Xét hai tập hợp $A$ và $B$. Ta gọi $\mathcal{R}$ là một quan hệ hai ngôi trên $A$ và $B$ nếu $\mathcal{R} \subset A \times B$. Trong đó $A \times B$ là tích Descartes của hai tập hợp.
\end{definition}

Nếu phần tử $(a, b) \in R$ với $a \in A$ và $b \in B$ thì ta nói \textbf{$a$ có quan hệ với $b$} và ký hiệu $a \mathcal{R} b$.

Khi $A \equiv B$ thì ta nói $\mathcal{R}$ là quan hệ hai ngôi trên $A$. Đây cũng là yếu tố quan trọng cho các khái niệm về sau.

\begin{example}
    Xét hai tập hợp $A = \{1, 2, 3, 4\}$ và $B = \{a, b, c\}$. Khi đó tích Descartes 
    \begin{align*}
        A \times B = \{
        & (1, a), (1, b), (1, c), (2, a), (2, b), (2, c), \\
        & (3, a), (3, b), (3, c), (4, a), (4, b), (4, c)
    \}
    \end{align*}

    Giả sử $\mathcal{R} = \{(1, a), (3, b), (4, c)\}$ thì 1 quan hệ với $a$ do $(1, a) \in \mathcal{R}$, hay $1 R a$. Tuy nhiên 1 không có quan hệ với $b$ do $(1, b) \not\in \mathcal{R}$.
\end{example}

Sau đây ta định nghĩa các loại quan hệ hai ngôi.

\begin{definition}
    Cho $R$ là quan hệ hai ngôi trên tập $A$. Ta nói
    \begin{enumerate}
        \item $\mathcal{R}$ \textbf{phản xạ} (hay \textbf{reflexive}) nếu với mọi $x \in A$ thì $(x, x) \in \mathcal{R}$;
        \item $\mathcal{R}$ \textbf{đối xứng} (hay \textbf{symmetric}) nếu $(x, y) \in \mathcal{R}$ thì $(y, x) \in \mathcal{R}$;
        \item $\mathcal{R}$ \textbf{phản xứng} (hay \textbf{antisymmetric}) nếu $(x, y) \in \mathcal{R}$ thì $(y, x) \not\in \mathcal{R}$. Nói cách khác nếu $(x, y) \in \mathcal{R}$ và $(y, x) \in \mathcal{R}$ thì $x = y$;
        \item $\mathcal{R}$ \textbf{bắc cầu} (hay \textbf{transitive}) nếu $(x, y) \in \mathcal{R}$ và $(y, z) \in \mathcal{R}$ thì $(x, z) \in \mathcal{R}$.
    \end{enumerate}
\end{definition}

\subsection*{Quan hệ tương đương}

Quan hệ tương đương giúp ta chia (phân hoạch) một tập hợp rời rạc thành các tập con mà chỉ cần một phần tử đại diện cho tập con đó là đủ để tính toán.

\begin{definition}[Quan hệ tương đương]
    Cho $\mathcal{R}$ là quan hệ trên tập $A$. Khi đó $\mathcal{R}$ được gọi là \textbf{quan hệ tương đương} nếu $\mathcal{R}$ phản xạ, đối xứng và bắc cầu.

    Ta có thể ký hiệu $x \mathcal{R} y$ với $\mathcal{R}$ là quan hệ tương đương là $x \sim y$ hoặc $x \widetilde{\mathcal{R}} y$.
\end{definition}

Tiếp theo ta định nghĩa lớp tương đương chứa phần tử $x$ và tập thương.

\begin{definition}[Lớp tương đương]
    Cho $\mathcal{R}$ là quan hệ tương đương trên tập $A$. Khi đó với $x \in A$, ta định nghĩa lớp tương đương chứa phần tử $x$ là tập các phần tử của $A$ có quan hệ với $x$ \[ \bar{x} = \{ y \in A, \, y \mathcal{R} x \} \]
\end{definition}

\begin{definition}[Tập thương]
    Tập hợp các lớp tương đương như trên tạo thành tập thương.
    \[A / \mathcal{R} = \{ \bar{x}, \, x \in A \}\]
\end{definition}

\begin{example}
    Xét số nguyên dương $n$. Với số nguyên $x$ và $y$, ta nói $x$ có quan hệ với $y$ nếu $n \vert (x - y)$, hay $x \equiv y \bmod n$. Ta ký hiệu quan hệ này là $n \ZZ$.

    Quan hệ trên là quan hệ tương đương vì
    \begin{enumerate}
        \item $n \vert 0 = x - x$ với mọi $x \in \ZZ$ nên có tính phản xạ;
        \item $n \vert (x - y) \Rightarrow n \vert -(x-y) = y-x$  với mọi $x, y \in \ZZ$ nên có tính đối xứng;
        \item $n \vert (x - y)$ và $n \vert (y - z)$ thì $n \vert (x - y + y - z) = (x - z)$ nên có tính bắc cầu.
    \end{enumerate}

    Từ đó ta có thể phân tập $\ZZ$ thành các lớp tương đương
    \begin{align*}
        \overline{0} & = \{ \ldots, -2n, -n, 0, n, 2n, \ldots \} \\
        \overline{1} & = \{ \ldots, -2n+1, -n+1, 1, n+1, 2n+1, \ldots \} \\
        \vdots \\
        \overline{n-1} & = \{ \ldots, -n-1, -1, n-1, 2n-1, 3n-1, \ldots \}
    \end{align*}

    Tập thương của chúng ta là $\ZZ / n\ZZ = \{ \overline{0}, \overline{1}, \ldots, \overline{n-1} \}$.
\end{example}

\subsection*{Quan hệ thứ tự}

\begin{definition}[Quan hệ thứ tự]
    Cho quan hệ $\mathcal{R}$ trên tập $A$. Ta nói $\mathcal{R}$ là quan hệ thứ tự nếu $\mathcal{R}$ phản xạ,  phản xứng và bắc cầu.
\end{definition}

\begin{definition}
    Cho tập hợp $A$ và quan hệ $\mathcal{R}$ trên $A$ là quan hệ thứ tự. Nếu $x \mathcal{R} y$ thì ta ký hiệu $x \prec y$. Khi đó $(A, \prec)$ được gọi là \textbf{tập có  thứ tự}.
\end{definition}

Tiếp theo là một số định nghĩa quan trọng về tập hợp có thứ tự.

\begin{definition}
    Với $(A, \prec)$ và $x, y \in A$,
    \begin{enumerate}
        \item Nếu $x \prec y$, ta nói \textbf{$y$ là trội của $x$}, hay là \textbf{$x$ được trội bởi $y$};
        \item $y$ là \textbf{trội trực tiếp} của $x$ nếu không tồn tại $z$ sao cho $x \prec z$ và $z \prec y$.
    \end{enumerate}
\end{definition}

\begin{definition}
    Xét $(A, \prec)$.
    \begin{enumerate}
        \item $x$ và $y$ thuộc $A$ được gọi là \textbf{so sánh được} nếu $x \prec y$ hoặc $y \prec x$;
        \item nếu với mọi $x, y \in A$, $x$ và $y$ so sánh được thì $(A, \prec)$ được gọi là \textbf{quan hệ thứ tự toàn phần}. Ngược lại thì gọi là \textbf{quan hệ thứ tự bán phần}.
    \end{enumerate}
\end{definition}

Để biểu diễn sự so sánh trong một tập hợp, ta sử dụng biểu đồ Hasse.

\begin{definition}
    Biểu đồ Hasse của $(A, \prec)$ với $A$ là tập hữu hạn bao gồm
    \begin{enumerate}
        \item Tập điểm - mỗi điểm biểu diễn một phần tử của $A$;
        \item Tập cung - vẽ một cung từ $x$ tới $y$ nếu $y$ là trội trực tiếp của $x$.
    \end{enumerate}
\end{definition}

\begin{example}
    Xét tập $U_{12} = \{ 1, 2, 3, 4, 6, 12 \}$ với quan hệ $x \mathcal{R} y$ được định nghĩa $x$ là ước của $y$.

    Theo đó, biểu đồ Hasse của quan hệ trên là hình \ref{hasse:1}.
    \begin{figure}[ht]
        \centering
        \includegraphics{figures/hasse/hasse1.pdf}
        \caption{Biểu đồ Hasse của $U_{12}$}
        \label{hasse:1}
    \end{figure}
\end{example}

\begin{definition}
    Xét quan hệ thứ tự $(A, \prec)$.
    \begin{enumerate}
        \item Phần tử $M \in A$ được gọi là
        \begin{enumerate}
            \item \textbf{Tối đại} nếu $M \prec x$ thì $x = M$;
            \item \textbf{Cực đại} (hay \textbf{lớn nhất}) nếu với mọi $x \in A$ thì $x \prec M$.
        \end{enumerate}
        \item Phần tử $m \in A$ được gọi là
        \begin{enumerate}
            \item \textbf{Tối tiểu} nếu $x \prec m$ thì $x = m$;
            \item \textbf{Cực tiểu} (hay \textbf{nhỏ nhất}) nếu với mọi $x \in A$ thì $m \prec x$.
        \end{enumerate}
    \end{enumerate}
\end{definition}

\begin{remark}
    \begin{enumerate}
        \item Phần tử cực đại nếu có là duy nhất. Tương tự cho cực tiểu;
        \item Nếu $n$ là phần tử tối đại duy nhất thì nó cũng là cực đại. Tương tự cho tối tiểu.
    \end{enumerate}
\end{remark}

Trong ví dụ $U_{12}$ ở trên thì 1 là tối tiểu và cũng là cực tiểu, và 12 là tối đại và cũng là cực đại.

\input{group_action.tex}

\chapter{Giải tích}

\section{Giới hạn}

\subsection*{Giới hạn của dãy số}

\begin{definition}[Giới hạn hữu hạn của dãy số]
    Cho dãy số $\{ a_n \}$. Ta nói dãy $\{ a_n \}$ có giới hạn hữu hạn $L$ nếu với mọi $\varepsilon > 0$, tồn tại $n_0 \in \NN$ sao cho với mọi $n \geqslant n_0$ thì 
    \begin{equation*}
        | a_{n} - L | < \varepsilon
    \end{equation*}

    Ký hiệu: $\displaystyle{\lim_{n \to \infty} a_n = L}$.
\end{definition}

\begin{example}
    Xét dãy số cho bởi công thức $a_n = \dfrac{1}{n}$. Ta chứng minh dãy số có giới hạn hữu hạn là 0.

    Với mọi $\varepsilon > 0$ tùy ý, ta cần chứng minh tồn tại số $n_0 \geqslant 1$ sao cho với mọi $n \geqslant n_0$ thì $| a_n - 0 | < \varepsilon$.

    Nói cách khác $a_{n_0} < \varepsilon$, hay tương đương với $\dfrac{1}{n_0} < \varepsilon \Leftrightarrow n_0 > \frac{1}{\varepsilon}$.

    Vậy ta chỉ cần chọn $n_0$ thỏa bất đẳng thức trên (luôn tìm được).

    Kết luận: $\displaystyle{\lim_{n \to \infty} a_n = 0}$
\end{example}

\begin{definition}[Dãy số có giới hạn vô cực]
    Cho dãy số $\{a_n\}$. Ta nói dãy số có giới hạn ở dương vô cực nếu với mọi $M > 0$, tồn tại $n_0 \in \NN$ sao cho với mọi $n \geqslant n_0$ thì $a_n > M$.
\end{definition}

Nói cách khác, nếu ta chọn một số $M$ rất lớn bất kì, thì mọi số hạng của dãy số kể từ một số hạng nào đó trở đi luôn lớn hơn $M$. Định nghĩa về dãy số có giới hạn ở âm vô cực cũng tương tự.

\subsection*{Giới hạn của hàm số}

Để định nghĩa giới hạn của hàm số $y = f(x)$ khi $x$ tiến tới $x_0$ ta có hai loại định nghĩa.

\begin{definition}[Giới hạn hàm số qua giới hạn dãy số]
    Xét hàm số $f(x)$. Ta nói hàm số có giới hạn hữu hạn $L$ khi $x$ tiến tới $x_0$, nếu với mọi dãy số $\{x_n\}$ mà $\displaystyle{\lim_{n \to \infty} x_n = x_0}$, thì  $\displaystyle{\lim_{n \to \infty} f(x_n) = L}$.
\end{definition}

Định nghĩa này tuân theo giới hạn của dãy số. Khi đó mọi phần tử của dãy số từ một số hạng nào đó trở đi cho giá trị $f(x_n)$ tiến về $L$.

Định nghĩa của hàm số theo kiểu Cauchy (hay còn được gọi là ngôn ngữ $\delta-\varepsilon$) là kiểu định nghĩa phổ biến được giảng dạy trong nhà trường.

\begin{definition}[Giới hạn hàm số kiểu Cauchy]
    Xét hàm số $f(x)$. Ta nói hàm số có giới hạn hữu hạn $L$ khi $x$ tiến tới $x_0$, nếu với mọi $\varepsilon > 0$, tồn tại  $\delta > 0$ sao cho với mọi $x$ mà $| x - x_0 | < \delta$ thì $|f(x) - L| < \varepsilon$.

    Ký hiệu: $\displaystyle{\lim_{x \to x_0} f(x) = L}$
\end{definition}

%Một cách hình ảnh, tương tự như giới hạn dãy số, lần này ta nhìn trên 2 trục  của mặt phẳng tọa độ $Oxy$. Với mọi quả cầu bán kính $\varepsilon$ tâm $L$ (dành cho $f(x)$) ta luôn chọn được quả cầu bán kính $\delta$ tâm $x_0$ (dành cho $x$). Lúc này khi $x$ nằm trong quả cầu tâm $x_0$ bán kính $\delta$ thì $f(x)$ tương ứng sẽ nằm trong quả cầu tâm $L$ bán kính $\varepsilon$.

Ta có thể thấy ở đây $x$ tiến về $x_0$ (khá giống định nghĩa giới hạn hàm số) và $f(x)$ tương ứng tiến về $L$.

Tương tự ta cũng có giới hạn hàm số ở vô cực.

\begin{definition}[Giới hạn hàm số ở vô cực]
    Với hàm số $f(x)$, ta nói hàm số có giới hạn tại dương vô cực khi $x$ tiến về $x_0$ nếu với mọi $M > 0$, tồn tại $\delta > 0$ sao cho với mọi $x$ mà $|x - x_0| < \delta$ thì $f(x) > M$.

    Ký hiệu: $\displaystyle{\lim_{x \to x_0} f(x) = +\infty}$.
\end{definition}

\begin{definition}[Giới hạn một bên]
    Ta nói hàm số $f(x)$ có giới hạn phải $L$ tại $x_0$ khi $x$ tiến về bên phải $x_0$ nếu với mọi $\varepsilon > 0$, tồn tại $\delta > 0$ sao cho với mọi $0 < x - x_0 < \delta$  thì $|f(x) - L| < \varepsilon$.

    Ký hiệu: $\displaystyle{\lim_{x \to x_0^+} f(x) = L}$
\end{definition}

Nghĩa là chúng ta chỉ xét giới hạn khi $x$ tiến tới $x_0$ từ bên phải $x > x_0$. Tương tự cho giới hạn trái.

Lưu ý rằng trong nhiều trường hợp, mặc dù cùng tiến tới $x_0$ nhưng giới hạn trái và giới hạn phải có thể không bằng nhau.

\begin{example}
    Xét hàm số $y = \frac{1}{x}$. Ta thấy hàm số không xác định tại $x = 0$, và giới hạn trái và phải khác nhau do \[\lim_{x \to 0^+} = +\infty, \quad \lim_{x \to 0^-} = -\infty\]
\end{example}

\subsection*{Tính liên tục của hàm số}

Cho hàm số $f(x)$ xác định trên miền $D$ và $x_0$ là một điểm thuộc $D$.

\begin{definition}[Hàm số liên tục tại một điểm]
    Ta nói hàm số $f(x)$ liên tục tại $x_0$ nếu \[\lim_{x \to x_0} f(x) = f(x_0)\]
\end{definition}

Định nghĩa tương tự cho liên tục trái và liên tục phải (ta lấy giới hạn một bên).

Như vậy, có 3 khả năng hàm số không liên tục tại một điểm.

\begin{enumerate}[noitemsep]
    \item Hàm số không xác định tại $x_0$
    \item Hàm số xác định tại $x_0$ nhưng giới hạn tại đó không bằng $f(x_0)$
    \item Giới hạn trái và giới hạn phải không bằng nhau
\end{enumerate}

Nếu hàm số không liên tục tại $x_0$ ta gọi hàm số bị \textbf{gián đoạn} tại $x_0$.

Nếu hàm số liên tục tại mọi điểm trên khoảng $(a, b)$ thì ta nói hàm số liên tục trên khoảng đó.

\section{Đạo hàm}

\begin{definition}[Đạo hàm]
    Cho hàm số $f(x)$ xác định trên miền $D$ và $x_0$ là điểm thuộc $D$. Ta nói hàm số $f(x)$ có đạo hàm tại $x_0$ (hoặc khả vi tại $x_0$) nếu tồn tại giới hạn hữu hạn
    \[\lim_{x \to x_0}\frac{f(x) - f(x_0)}{x - x_0}\]

    Ký hiệu đạo hàm của $f$ tại $x_0$ là $f'(x_0)$.
\end{definition}

\begin{example}
    Xét hàm số $f(x) = x^2 + 1$ trên $\RR$. Tìm đạo hàm tại $x_0 \in \RR$.

    Ta có $f(x)-f(x_0) = x^2 + 1 - (x_0^2 + 1) = (x - x_0) (x + x_0)$.

    Khi đó $\frac{f(x)-f(x_0)}{x-x_0} = x + x_0$ nên ta có $\displaystyle{\lim_{x \to x_0} (x + x_0) = 2 x_0}$.
\end{example}

Nếu hàm số khả vi trên mọi điểm thuộc khoảng (đoạn) nào đó thì ta nói hàm số khả vi trên khoảng (đoạn) đó và ký hiệu là $f'(x)$.

Với ví dụ trên, ta thấy giới hạn tồn tại với mọi $x_0 \in \RR$ nên ta có thể thay $x_0$ bởi $x$ và có $f'(x) = 2x$ với $f(x) = x^2 + 1$.

\begin{remark}
    Từ định nghĩa ta thấy rằng nếu $f(x)$ khả vi tại $x_0$ thì nó cũng liên tục tại $x_0$. Tuy nhiên chiều ngược lại không đúng. Ví dụ với hàm số $y = \lvert x \rvert$, hàm số liên tục tại $x=0$ nhưng giới hạn (đạo hàm) phải là 1, còn giới hạn (đạo hàm) trái là -1.
\end{remark}

Về mặt hình ảnh, khi hàm số khả vi tại một điểm thì đồ thị sẽ "trơn", không gấp khúc tại điểm đó.

\subsection*{Cực trị}

Đầu tiên chúng ta cần một định lý về tính đơn điệu của hàm số
khả vi.

\begin{theorem}
    Xét hàm số $f(x)$ khả vi trên khoảng $(a, b)$. Nếu $f'(x) > 0$ 
    với mọi $x \in (a, b)$ thì $f(x)$ đồng biến trên $(a, b)$.
\end{theorem}

Tương tự, $f'(x) < 0$ với mọi $x \in (a, b)$ thì $f(x)$ nghịch biến trên
$(a, b)$.

\begin{definition}[Cực tiểu của hàm số]
    Xét hàm số $f(x)$ liên tục trên khoảng $(a, b)$. Điểm $(x_0, f(x_0))$ được
    gọi là \textbf{cực tiểu} của hàm số $f(x)$ nếu tồn tại một lân cận $U$
    chứa $x_0$ nằm trong khoảng $(a, b)$ sao cho với mọi $x \in U$ thì $f(x) \geqslant f(x_0)$.
\end{definition}

\begin{definition}[Cực đại của hàm số]
    Xét hàm số $f(x)$ liên tục trên khoảng $(a, b)$. Điểm $(x_0, f(x_0))$ được
    gọi là \textbf{cực đại} của hàm số $f(x)$ nếu tồn tại một lân cận $U$
    chứa $x_0$ nằm trong khoảng $(a, b)$ sao cho với mọi $x \in U$ thì $f(x) \leqslant f(x_0)$.
\end{definition}

Theo định nghĩa cực tiểu thì chỉ cần tồn tại lân cận chứa $x_0$
mà $f(x) \geqslant f(x_0)$ thì điểm đó là cực tiểu. Như vậy một hàm số có 
thể có nhiều cực tiểu, tương tự cũng có thể có nhiều cực đại.

Lưu ý rằng cực đại và cực tiểu không phải điểm chỉ giá trị lớn nhất
hay giá trị nhỏ nhất của hàm số. Nó chỉ lớn nhất hoặc nhỏ nhất trong
vùng lân cận đó theo định nghĩa, nên người ta còn gọi là cực trị địa phương.

%Xét hàm số $f(x)$ khả vi trên khoảng $(a, b)$. Gọi $f'(x)$ là
%đạo hàm của hàm số $f(x)$ trên $(a, b)$. Khi đó điểm $x_0 \in (a, b)$ được gọi là
%\begin{itemize}
 %   \item Cực tiểu nếu $f'(x)$ đổi chiều từ âm sang dương khi đi qua $x_0$
 %   \item Cực đại nếu $f'(x)$ đổi chiều từ dương sang âm khi đi qua $x_0$
%\end{itemize}

\begin{definition}[Dãy Cauchy]
    Dãy $(x_n)$ được gọi là dãy Cauchy nếu với mọi $\varepsilon > 0$, tồn tại $N_0 \in \NN$ sao cho, với mọi $m, n > N_0$ thì $\lvert x_m - x_n \rvert < \varepsilon$.
\end{definition}

\begin{theorem}[Tiêu chuẩn Cauchy]
    Dãy số $(x_n)$ có giới hạn hữu hạn khi và chỉ khi nó là dãy Cauchy.
\end{theorem}

\begin{theorem}[Bổ đề Fermat]
    Cho $f$ là một hàm số có đạo hàm trên $(a, b)$. Nếu $x_0 \in (a, b)$ là một điểm cực trị của $f$ thì ta có $f'(x_0) = 0$.
\end{theorem}

\begin{proof}
    Ta chứng minh trong trường hợp $x_0$ là điểm cực tiểu. Trường hợp điểm cực đại tương tự.

    Hàm $f$ có đạo hàm trên $(a, b)$ nên tại điểm $x_0$ nó có đạo hàm bên trái và đạo hàm bên phải, và hai đạo hàm này bằng nhau.

    Ta có $\displaystyle{f'(x_0^+) = \lim_{x \to x_0^+} \frac{f(x) - f(x_0)}{x - x_0}}$. Vì $x \to x_0^+$ nghĩa là $x > x_0$ ($x$ tiến tới $x_0$ từ bên phải), và do $x_0$ là cực tiểu $f(x) - f(x_0) \geqslant 0$ nên phân số dưới dấu giới hạn lớn hơn 0. Suy ra $f'(x_0^+) \geqslant 0$.

    Hoàn toàn tương tự ta chứng minh được $f'(x_0^-) \leqslant 0$. Và do $f'(x_0^+) = f'(x_0^-) = f'(x_0)$ nên $f'(x_0) = 0$.

    Ta có điều phải chứng minh.
\end{proof}

\begin{theorem}[Định lí Rolle]
    Xét hàm số $f$ liên tục trên đoạn $[a, b]$, có đạo hàm trên khoảng $(a, b)$ và $f(a) = f(b)$. Khi đó tồn tại $c$ thuộc $(a, b)$ sao cho $f'(c) = 0$.
\end{theorem}

\begin{theorem}[Định lí Lagrange]
    Xét hàm số $f$ liên tục trên đoạn $[a, b]$, có đạo hàm trên khoảng $(a, b)$. Khi đó tồn tại $c$ thuộc $(a, b)$ sao cho $f'(c) (b - a) = f(b) - f(a)$.
\end{theorem}

\begin{definition}[Hàm lõm]
    Hàm số $f$ liên tục trên khoảng $\II$ nếu với mọi $\alpha, \beta$ mà $\alpha + \beta = 1$ ta đều có 
    \begin{equation}
        f(\alpha x + \beta y) \leqslant \alpha f(x) + \beta f(y), \quad \forall x, y \in \II
    \end{equation}
\end{definition}

\input{quantum_computing.tex}

\input{probability.tex}

\input{analytic_geometry/analytic_geometry.tex}

\input{affine_geometry.tex}

\input{machine_learning.tex}

\input{zero_knowledge_proof.tex}

\printbibliography[title={Tài liệu tham khảo}]

\appendix

\input{nsucrypto/2021/nsucrypto_2021.tex}

\input{nsucrypto/2022/nsucrypto_2022.tex}

\input{nsucrypto/2023/nsucrypto_2023.tex}

\input{onthi.tex}

\chapter{Đường đoản thời}

\section*{Lời nói đầu}

Động lực để tác giả viết bài này là sau khi đọc về sự ra đời phép tính vi tích phân cùng vụ tranh cãi đáng xấu hổ trong lịch sử toán học giữa Newton và Leibniz, cùng với bài toán của Johann Bernoulli. 
        
Bài nghiên cứu này được tham khảo nhiều nguồn (từ Miguel A. Lerma\footnote{\emph{A simple derivation of the equation for the brachistochrone curve}, \url{https://sites.math.northwestern.edu/~mlerma/papers-and-preprints/brachistochrone.pdf}} và Lê Quang Ánh\footnote{\emph{Gia đình Bernoulli: một dòng họ Toán học}, trang 7, \url{https://rosetta.vn/lequanganh/gia-dinh-bernoulli-mot-dong-ho-toan-hoc/}}) và là tài liệu học tập cá nhân. Tác giả hy vọng rằng bài nghiên cứu nhỏ này sẽ giúp ích được cho các bạn học sinh, sinh viên đam mê toán và vật lý (mặc dù tác giả không phải dân lý hihi).

\section*{Bối cảnh lịch sử}

Thế kỷ 17 đã chứng kiến một drama có thể gọi là đáng xấu hổ nhất lịch sử toán học. Hai nhà toán học có ảnh hưởng rất lớn lại vướng vào một vụ kiện tụng và tranh cãi khó coi để xem ai là người phát minh ra phép tính vi tích phân. Vâng, chúng ta đang nói đến Newton và Leibniz. Vào thời điểm đó có một nhà toán học xuất sắc thuộc một dòng họ cũng gồm rất nhiều nhân vật xuất sắc đã đưa ra một bài toán đố cho các nhà toán học trên thế giới. Bài toán đó đã chứng minh được ưu thế vượt trội trong phương pháp vi tích phân của Leibniz.
    
Nhà toán học xuất sắc đó là Johann Bernoulli, thuộc dòng họ Bernoulli nổi tiếng. Bài toán đó được phát biểu như sau:
    
\textit{Cho hai điểm A và B nằm trong mặt phẳng thẳng đứng P (A cao hơn B). Hãy 
    xác định đường nối hai điểm A và B và nằm trong mặt phẳng P sao cho một 
    điểm chỉ chịu trọng lực chạy từ A đến B trong thời gian ngắn nhất.}

Chúng ta đã biết rằng đường đi ngắn nhất giữa hai điểm là đoạn thẳng nối hai điểm đó. Tuy nhiên trong bài toán của Johann Bernoulli thì đại lượng ngắn nhất cần tìm không phải khoảng cách giữa hai điểm mà là thời gian di chuyển giữa hai điểm. Mục tiêu cần làm ở bài toán này là xác định đường đi (hay quỹ đạo) thời gian ngắn nhất đó. Do đó bài toán này được gọi là bài toán \textit{đường đoản thời} (brachistochrone curve).

Để giải bài toán này chúng ta cần một định luật cũng về thời gian ngắn nhất. Đó là nguyên lý thời gian ngắn nhất của Fermat và một hệ quả của nó là định luật Snell-Descartes.

\section*{Định luật Snell-Descartes}

\begin{figure}[ht]
    \centering
    \includegraphics{brachistochrone/fermat.pdf}
    \caption{Định luật Snell-Descartes}
    \label{cycloid:snell}
\end{figure}

Nguyên lý thời gian ngắn nhất của Fermat phát biểu rằng

\textit{Khi ánh sáng truyền từ môi trường này sang môi trường khác thì nó luôn truyền đi theo đường nhanh nhất.}

Hệ quả của nguyên lý của Fermat là định luật Snell-Descartes mà chúng ta thường thấy ở chương trình vật lý ở phổ thông dưới dạng định luật khúc xạ ánh sáng
\begin{equation}
    \frac{\sin \alpha_1}{\sin \alpha_2} = \frac{v_1}{v_2}
\end{equation}
với $\alpha_1$ và $\alpha_2$ lần lượt là góc hợp bởi tia vào và tia ra với pháp tuyến tại điểm tới, $v_1$ và $v_2$ là vận tốc truyền trong môi trường ở nửa trên và nửa dưới $Ox$ (xem hình \ref{cycloid:snell}).

Để chứng minh định luật trên, ta thấy rằng $v_1$ là vận tốc khi di chuyển từ điểm $P$ tới điểm $R$ nên thời gian $t_1$ đi từ điểm $P$ tới $R$ là
\begin{equation}
    t_1 = \frac{\lVert \overrightarrow{PR} \rVert}{v_1} = \frac{\sqrt{(x - x_1)^2 + y_1^2}}{v_1}
\end{equation}

Lưu ý rằng tia sáng không truyền tới gốc tọa độ $O(0,0)$ mà truyền tới một điểm $R(x,0)$ là vì điểm bắt đầu là $P(x_1, y_1)$ và ánh sáng truyền đi theo đường nhanh nhất (theo nguyên lý Fermat) nên không có gì đảm bảo rằng nó sẽ truyền tới $O(0, 0)$.

Tương tự, thời gian $t_2$ đi từ điểm $R$ tới $Q$ là
\begin{equation}
    t_2 = \frac{\lVert \overrightarrow{RQ} \rVert}{v_2} = \frac{\sqrt{(x - x_2)^2 + y_2^2}}{v_2}
\end{equation}

Kết hợp hai phương trình của $t_1$ và $t_2$ lại thì tổng thời gian di chuyển từ $P$ tới $Q$ biểu diễn theo $x$ là
\begin{equation}
    T(x) = t_1 + t_2 = \frac{\sqrt{(x - x_1)^2 + y_1^2}}{v_1} + \frac{\sqrt{(x - x_2)^2 + y_2^2}}{v_2}
\end{equation}

Đạo hàm theo $x$ ta có
\begin{equation}
    T'(x) = \frac{x - x_1}{v_1 \sqrt{(x - x_1)^2 + y_1^2}} + \frac{x - x_2}{v_2 \sqrt{(x - x_2)^2 + y_2^2}}
\end{equation}

Để ý rằng $x > x_1$ nên $x - x_1 = \lVert \overrightarrow{PP'} \rVert$. Tương tự $x_2 - x = \lVert \overrightarrow{QQ'} \rVert$. Để tìm cực trị ta cho đạo hàm bằng 0 rồi tính đạo hàm cấp 2. Ta có
\begin{equation*}
    T'(x) = 0 \Leftrightarrow \frac{\lVert \overrightarrow{PP'} \rVert}{v_1 \lVert \overrightarrow{PR} \rVert} - \frac{\lVert \overrightarrow{QQ'} \rVert}{v_2 \lVert \overrightarrow{RQ} \rVert} = 0 \Leftrightarrow \frac{\sin \alpha_1}{v_1} - \frac{\sin \alpha_2}{v_2} = 0
\end{equation*}

Như vậy $\dfrac{\sin \alpha_1}{v_1} = \dfrac{\sin \alpha_2}{v_2}$. Đạo hàm cấp 2 tương ứng là
\begin{equation*}
    T''(x) = \frac{y_1^2}{v_1 ((x - x_1)^2 + y_1^2)} + \frac{y_2^2}{v_2 ((x - x_2)^2 + y_2^2)} > 0
\end{equation*}

Do đó $x$ thỏa $T'(x) = 0$ ở trên là cực tiểu và định luật Snell-Descartes được chứng minh.

\section*{Đường cong Cycloid}

Đáp án cho bài toán mà Johann Bernoulli đặt ra là đường cong Cycloid. Sau đây sẽ trình bày cách giải bài toán của Johann Bernoulli.

\begin{figure}[ht]
    \centering
    \includegraphics{brachistochrone/brachistochrone.pdf}
    \caption{Đường cycloid}
    \label{cycloid:im1}
\end{figure}

Phương của vận tốc tức thời tại một điểm khi một vật đi theo một quỹ đạo đường cong là tiếp tuyến với đường cong tại điểm đó. Khi đó góc $\alpha$ trong định luật Snell-Descartes sẽ có liên hệ với hệ số góc của tiếp tuyến với đường cong. Nói rõ hơn, góc hợp bởi tiếp tuyến và trục $Ox$ là $\alpha + \dfrac{\pi}{2}$ và hệ số góc của tiếp tuyến là $\tan \Bigl(\alpha + \dfrac{\pi}{2}\Bigr) = \dfrac{dy}{dx}$ (hình \ref{cycloid:im1}).

Ta có $\tan \Bigl( \alpha + \dfrac{\pi}{2} \Bigr) = -\cot \alpha$ và $1 + \cot^2 \alpha = \dfrac{1}{\sin^2 \alpha}$ nên 
\begin{equation}
    \dfrac{1}{\sin^2 \alpha} = 1 + \cot^2 \alpha = 1 + \Bigl(\dfrac{dy}{dx}\Bigl)^2
\end{equation}

Giả sử tọa độ của $A$ là $(x_0, y_0)$. Khi một điểm di chuyển từ $A$ tới $B$, gọi $(x, y)$ là tọa độ của điểm đó trên đường cong. Theo định luật bảo toàn cơ năng thì 
\begin{equation*}
    m g y_0 = \frac{1}{2} m v^2 + m g y
\end{equation*}
với $v$ là vận tốc tức thời tại điểm $(x, y)$ và $mgy$ là thế năng tại điểm đó. Như vậy ta có 
\begin{equation}
    v^2 = 2 g (-y + y_0)
\end{equation}

Theo định luật Snell-Descartes thì $\dfrac{v}{\sin \alpha}$ là một hằng số khi nằm trong cùng môi trường. Do đó tồn tại số $r$ cố định sao cho $\dfrac{v^2}{\sin^2 \alpha} = 4 g r$. Từ hai biểu thức của $v^2$ và $\dfrac{1}{\sin^2 \alpha}$ ở trên ta có
\begin{equation}
    \frac{v^2}{\sin^2 \alpha} = 2 g (-y + y_0) \Bigl( 1 + \Bigl(\frac{dy}{dx}\Bigr)^2 \Bigr) = 4 g r
\end{equation}

Suy ra
\begin{equation}
    \Big(\frac{dy}{dx}\Big)^2 = \frac{2 r}{y_0 - y} - 1
    \label{diff:eq1}
\end{equation}

Tới đây ta thấy rằng bậc của $dy$ và $dx$ ở vế trái là giống nhau, trong khi vế phải chỉ có $y$ mà không có $x$. Do đó "bắt chước" cách đổi biến của đường tròn, đặt
\begin{equation*}
    \begin{cases}
        x = a \theta + b \cos \theta \\
        y = c + d \sin \theta
    \end{cases}
\end{equation*}
với $a$, $b$, $c$, $d$ là các số thực cần tìm, $\theta$ là góc hợp bởi $Oy$ và đoạn thẳng nối tâm $O$ và điểm trên đường cong (theo góc $\alpha$). Lưu ý rằng khi thay $\theta = 0$ và $\theta = \pi / 2$ vào hai phương trình trên ta phải thu được hai điểm trên hai trục tọa độ.

Lấy vi phân hai phương trình trên ta có
\begin{equation*}
    \begin{cases}
    dx = a - b \sin \theta \, d \theta \\ dy = d \cos \theta \, d \theta
\end{cases}
\end{equation*}

Thay vào phương trình \ref{diff:eq1} ta được
\begin{equation*}
    \frac{d^2 \cos^2 \theta}{(a - b \sin \theta)^2} = \frac{2 r}{y_0 - c - d \sin \theta} - 1 = \frac{2 r - y_0 + c + d \sin \theta}{y_0 - c - d \sin \theta}
\end{equation*}

Do $\cos^2 \theta = 1 - \sin^2 \theta = (1 - \sin \theta)(1 + \sin \theta)$ nên ta muốn chọn $a$ và $b$ có thể rút gọn được cho tử số. 

\textbf{Trường hợp 1}. $a = b$, ta thu được
\begin{equation*}
    \frac{d^2 (1 + \sin \theta)}{a^2 (1 - \sin \theta)} = \frac{(2 r - y_0 + c) + d \sin \theta}{(y_0 - c) - d \sin \theta}
\end{equation*}

Ta sẽ muốn đồng nhất hệ số tự do và hệ số trước $\sin \theta$ để dễ tính toán sau này. Do đó một cách chọn đơn giản là $2 r - y_0 + c = d$ và $y_0 - c = d$. Suy ra $r = d$. Thu gọn phương trình ta được
\begin{equation*}
    \frac{d^2 (1 + \sin \theta)}{a^2 (1 - \sin \theta)} = \frac{1 + \sin \theta}{1 - \sin \theta}
\end{equation*}

Như vậy $a^2 = d^2$ nên $a = d$ hoặc $a = -d$. Ta xét trường hợp $a = d$, trường hợp $a = -d$ cũng cho kết quả tương tự (không thỏa mãn). 

Ta có  $a = b = d = r$ và $c = y_0 - d = y_0 - r$. Phương trình đường cong trong tọa độ cực sẽ là
\begin{equation*}
    \begin{cases}
        x = r(\theta + \cos \theta) \\ y = (y_0 - r) + r \sin \theta
    \end{cases}
\end{equation*}

Với $\theta = 0$ thì $(x, y) = (r, y_0 - r$. Với $\theta = \pi / 2$ thì $(x, y) = (\pi r / 2, y_0)$.

Tới đây chúng ta có thể thêm bớt một hằng số để "kéo" các tọa độ về trục. 

Ta đưa tọa độ khi $\theta = 0$ về $Oy$ thì $x' = x - r$. Tương tự tọa độ khi $\theta = \pi / 2$ sẽ về $Ox$ nên $y' = y - y_0$. Như vậy tọa độ (mới) cho hai trường hợp $\theta$ là $(0, -r)$ và $(\pi r / 2 - 1, 0)$ nhưng vì $r$ là số dương (bán kính) nên $(0, -r)$ nằm dưới trục $Ox$, không phù hợp với hình vẽ.

\textbf{Trường hợp 2}. $a = -b$, ta thu được
\begin{equation*}
    \frac{d^2 (1 - \sin\theta)}{a^2 (1 + \sin\theta)} = \frac{(2r - y_0 + c) + d \sin\theta}{(y_0 - c) - d \sin\theta}
\end{equation*}

Tương tự, để đồng nhất và rút gọn hệ số cho hợp với bên vế trái ta chọn $2r - y_0 + c = -d$ và $y_0 - c = -d$. Suy ra $d = -r$. Thu gọn phương trình ta được
\begin{equation*}
    \frac{d^2 (1 - \sin\theta)}{a^2 (1 + \sin\theta)} = \frac{1 - \sin\theta}{1 + \sin\theta}
\end{equation*}

Như vậy $a^2 = d^2$ nên $a = d$ hoặc $a = -d$ Ta xét trường hợp $a = -d$.

Khi đó $a = -b = -d = r$ và $c = y_0 + d = y_0 - r$. Phương trình đường cong trong tọa độ cực sẽ là 
\begin{equation*}
    \begin{cases}
        x = r (\theta - \cos\theta) \\
        y = (y_0 - r) - r \sin\theta
    \end{cases}
\end{equation*}

Với $\theta = 0$ thì $(x, y) = (-r, y_0)$. Với $\theta = \pi / 2$ thì $(x, y) = (r (\pi / 2 - 1), y_0 - 2r)$.

Tới đây ta cũng thêm bớt một hằng số vào hoành độ và tung độ để "kéo" các tọa độ về trục.

Ta đưa tọa độ khi $\theta = 0$ về $Oy$ thì $x' = x + r$. Tương tự ta đưa tọa độ khi $\theta = \pi / 2$ về $Ox$ thì $y' = y - y_0 + 2r$. Khi đó tọa độ (mới) là $(0, 2r)$ và $(\pi r / 2, 0)$. Điều này phù hợp với yêu cầu bài toán và tương đương với phương trình trong tọa độ cực 
\begin{equation}
    \begin{cases}
        x = r (\theta - \cos\theta) + r = r (1 + \theta - \cos\theta) \\
        y = (y_0 - r) - r \sin\theta - (y_0 - 2r) = r (1 - \sin\theta)
    \end{cases}, 0 \leqslant \theta \leqslant \frac{\pi}{2}
\end{equation}

Đây chính là kết quả cần tìm. Thêm nữa vị trí ban đầu của vật là $(0, y_0)$ và tọa độ theo phương trình là $(0, 2r)$ nên suy ra $y_0 = 2r$.

\section*{Phương trình phụ thuộc thời gian}

Trong phương trình đường cong có sự tham gia của bán kính $r$ cố định và góc quét $\theta$. Chúng ta cần mối liên hệ giữa các phương trình theo thời gian.

Nhắc lại, vận tốc tức thời tại một điểm có phương trùng với tiếp tuyến với đường cong tại điểm đó. Do đó $v = \dfrac{\sqrt{(dy)^2 + (dx)^2}}{dt}$ xác định vận tốc tức thời với quãng đường là $(dy)^2 + (dx)^2$ là bình phương khoảng cách trong mặt phẳng. Từ đây suy ra
\begin{align*}
    v^2 = \Bigl(\frac{dy}{dt}\Bigr)^2 + \Bigl(\frac{dx}{dt}\Bigr)^2 = r^2 \cos^2 \theta \Bigl( \frac{d \theta}{dt} \Bigr)^2 + r^2 (1 + \sin \theta)^2 \Bigl( \frac{d \theta}{dt} \Bigr)^2 \\ = 2 r^2 (1 + \sin \theta) \Bigl( \frac{d \theta}{dt} \Bigr)^2
\end{align*}

Từ bên trên và $y_0 = 2r$ ta có \[v^2 = 2 g (y_0 - y) = 2 g (y_0 - r + r \sin \theta) = 2 g r ( 1 + \sin \theta)\]

Suy ra
\begin{equation*}
    2 r^2 (1 + \sin \theta) \Bigl( \frac{d \theta}{dt} \Bigr)^2 = 2 g r (1 + \sin \theta)
\end{equation*}
Hay
\begin{equation}
    \Bigl(\frac{d \theta}{dt}\Bigr)^2 = \frac{g}{r} \Rightarrow \frac{d \theta}{dt} = \sqrt{\frac{g}{r}} = \text{const}
\end{equation}

Như vậy $\theta = \sqrt{\dfrac{g}{r}} t = \omega t$. Ở đây $t$ là thời gian tính từ lúc bắt đầu thả vật từ điểm $A$. Cuối cùng phương trình phụ thuộc thời gian của đường cong Cycloid là
\begin{equation}
    \begin{cases}
        x = r (1 + \omega t - \cos \omega t) \\ y = r (1 - \sin \omega t)
    \end{cases}
\end{equation}

Trong đó, $r$ là bán kính cố định (bằng nửa độ cao ban đầu $y_0$ của vật), $\omega = \frac{g}{r}$ là tần số góc, $y_0$ là độ cao ban đầu của vật (tung độ điểm $A$).

\input{assembly.tex}
\end{document}